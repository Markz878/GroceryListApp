@inherits LayoutComponentBase

<main id="main">
    <nav id="top-row">
        <div id="top-row-content">
            <div id="logo">
                <a href="/"><img id="logo-img" width="48" src="/cart128.png" alt="Logo" /></a>
                <h3 id="logo-header">Grocery List Helper</h3>
            </div>
            @if (loggedInUserInfo?.IsAuthenticated == true)
            {
                @if (Navigation.Uri.Contains("group"))
                {
                    <button class="btn btn-success" @onclick="NavigateToIndex">My Cart</button>
                }
                else
                {
                    <button class="btn btn-success" @onclick="NavigateToGroups">Cart Groups</button>
                }
                <div class="profile-menu-container">
                    <button id="profile-btn" class="profile-btn" @onclick="ToggleUserMenuOpen">@GetUserInitials(loggedInUserInfo)</button>
                    @if (userMenuOpen)
                    {
                        <div class="profile-menu">
                            @if (loggedInUserInfo?.Claims?.FirstOrDefault(x => x.Type == "name")?.Value is not null)
                            {
                                <p>@loggedInUserInfo.Claims.FirstOrDefault(x=>x.Type == "name")!.Value</p>
                            }
                            @if (loggedInUserInfo?.Claims?.FirstOrDefault(x => x.Type == "preferred_username")?.Value is not null)
                            {
                                <p>@loggedInUserInfo.Claims.FirstOrDefault(x=>x.Type == "preferred_username")!.Value</p>
                            }
                            <form id="signout-form" method="post" action="api/Account/Logout">
                                <AntiForgeryTokenInput />
                                <button id="signout-btn" class="profile-menu-btn" type="submit">
                                    <i class="fa fa-sign-out" aria-hidden="true"></i>
                                    Sign out
                                </button>
                            </form>
                        </div>
                    }
                </div>
            }
            else
            {
                <a id="login-link" class="nav-link" href="api/Account/Login">Log in</a>
            }
        </div>
    </nav>

    <div id="content">
        @Body
    </div>
</main>

<Modal />